<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mon Équipe</title>
    <link rel="stylesheet" href="../main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
</head>
<body>
<div class="container">
    <div class="navbar-aside">
        <img id="logo-ekod" src="../img/logoEkod.svg" alt="ekod">
        <ul>
            <li><img src="../img/dashboard.png"><a href="../pages/mon-equipe.html">MON EQUIPE</a></li>
            <li><img src="../img/speedometer.png"><a href="../pages/races.html">COURSES</a></li>
            <li><img src="../img/marketplace.png"><a href="../pages/marketplace.html">MARKETPLACE</a></li>
        </ul>
    </div>
    <div class="section">
        <div id="case1">
            <div id="myTeamName"></div>
            <div class="my-team-info">
                <ul id="myTeamInfo"></ul>
                <ul id="myTeamMedal"></ul>
            </div>
            <ul id="teams-list"></ul>
            <div id="team-info"></div>
        </div>
        <div id="case2">
            <h2>Mon véhicule</h2>
            <img>
            <div class="my-team-vehicule">
                <img id="image-floating-cars" src="/img/notreVoiture.png">
                <ul id="myTeamVehicule"></ul>
                <div class="progress-container">
                    <div class="progress">
                        <div class="progress-bar" style="width: 50%;"></div>
                    </div>
                    <div class="progress">
                        <div class="progress-bar" style="width: 75%;"></div>
                    </div>
                    <div class="progress">
                        <div class="progress-bar" style="width: 20%;"></div>
                    </div>
                    <div class="progress">
                        <div class="progress-bar" style="width: 40%;"></div>
                    </div>
                    <div class="progress">
                        <div class="progress-bar" style="width: 90%;"></div>
                    </div>
                    <div class="progress">
                        <div class="progress-bar" style="width: 60%;"></div>
                    </div>
                    <div class="progress">
                        <div class="progress-bar" style="width: 30%;"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="my-team-inventory">
            <img>
            <div>
                <h1>Inventaire</h1>
                <div id="inventory"></div>
            </div>
            </div>
        </div>
</div>

<script src="../js/monEquipe.js/"></script>
<script src="../js/afficheInventaire.js"></script>
<script>
    const inventoryDiv = document.getElementById('inventory');

    async function fetchInventory() {
        const response = await fetch('http://185.98.136.60:9090/teams/20/inventory', {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJITlhWT3dMMVNwaXRINmh0Q052aVJPSjlrcjFSd05PM3NqckVqbTdlWUswIn0.eyJleHAiOjE2ODA0MjE0NzMsImlhdCI6MTY4MDM5OTk1MiwiYXV0aF90aW1lIjoxNjgwMzg1NDczLCJqdGkiOiJiZjcwYzA1OC02YzI3LTRmMzAtODI3MC1lMmVkMzRkMTJjMDQiLCJpc3MiOiJodHRwOi8vMTg1Ljk4LjEzNi42MDo4MDgwL3JlYWxtcy9jb2RlbGVtYW5zIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6Ijk2NmI4MTFmLTU0YzYtNGVkNS1iMDE5LTE5YmNiY2UwNmQ4MSIsInR5cCI6IkJlYXJlciIsImF6cCI6ImFwcC1kZWZpLTI0aCIsIm5vbmNlIjoiMmFjODUxZGQtNTMwNS00MGY2LWJkYzItYjhmZWFkZGJjNjczIiwic2Vzc2lvbl9zdGF0ZSI6ImEyMGQzYzZlLWU2ZTQtNGE3Mi1iZWMxLTk0YTgwNDEzNTc1MyIsImFjciI6IjAiLCJhbGxvd2VkLW9yaWdpbnMiOlsiKiJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJkZWZhdWx0LXJvbGVzLWNvZGVsZW1hbnMiLCJ1bWFfYXV0aG9yaXphdGlvbiIsInVzZXIiXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBlbWFpbCBwcm9maWxlIiwic2lkIjoiYTIwZDNjNmUtZTZlNC00YTcyLWJlYzEtOTRhODA0MTM1NzUzIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInByZWZlcnJlZF91c2VybmFtZSI6ImltcG9ydGFudCIsInRlYW1faWQiOiIyMCIsImdpdmVuX25hbWUiOiIiLCJmYW1pbHlfbmFtZSI6IiIsInRlYW1fbmFtZSI6IiFJbXBvcnRhbnQifQ.SKRU7-KZeqPlqiLl3VWcBqHvGLTi5BHvFagQiPYxK5BbIiUkduqN-o2KsewpMTuxT1vdLp-aOS2VFUxan9ejohdK8irrjWiuUM3z0b62U6BirloPb3qVfiek7Tj6EmIRjsy25XipUwRqTYJmSNTfWpvvdYifBagXVMb4C4Tpc5Knj65PwnP0mXYsVbAzikTkKcQY8O9YFdLCax5rWgwQCo8QkKjVYGgSoBuOuR3UuSBqQsEG23YVoboq5fhIbA6CiMc0UkeLAv419R2lqpMGw09DejkBbOqlsF-IChapya_pep6JqAZdPZSe2BDa3QPKsWTTtEliLZOb5mPNRWuRxA'
            }
        });
        const data = await response.json();
        const inventory = data.items;
        return inventory;""
    }

    function createInventoryLi(item) {
        const div = document.createElement('div');
        div.classList.add('inventory-item');

        const itemImg = document.createElement('img');
        var slash = item.item.image.split('../../');
        console.log(slash)
        itemImg.setAttribute('src', `${slash[1]}.png`);

        div.appendChild(itemImg);

        const itemName = document.createElement('span');
        itemName.textContent = `${item.item.name} (${item.item.type})`;
        if (item.isEquipped) {
            itemName.classList.add('equipped');
        }
        div.appendChild(itemName);

        const sellBtn = document.createElement('button');
        sellBtn.textContent = 'Vendre';
        sellBtn.addEventListener('click', () => {
            sellItem(item.item.id);
        });
        div.appendChild(sellBtn);

        return div;
    }

    async function sellItem(itemId) {
        // TODO: implémenter la logique pour vendre l'article sur le marché
        console.log(`Vendre l'article avec l'ID: ${itemId}`);
    }

    async function displayInventory() {
        const inventory = await fetchInventory();
        for (const item of inventory) {
            const li = createInventoryLi(item);
            inventoryDiv.appendChild(li);
        }
    }
    displayInventory();
</script>


</body>
</html>